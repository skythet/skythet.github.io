---
title: Mysql-ге қашықтықтан қосылудың үш тәсілі
category: MySQL
Tags: mysql, ssh
image: mysql.jpg
---

MySQL-ге қашықтықтан қосылудың үш түрлі әдісін қарастырамыз.


Mysql localhost-та тұрғанда қалай қосылуды жақсы білеміз:
{% highlight bash %}
mysql -uroot -pxxxx
{% endhighlight %}
Ал егер mysql басқа серверде немесе виртуалкада болса ше? Оған қалай қосыламыз. Виртуалканы ашып, соның терминалында жұмыс жасай беруге болады, бірақ бұлай қашанғы жұмыс жасайсың. Сонымен төменде қашықтықтан mysql-ге қосылудың үш тәсілі келтірілген.

**1. SSH арқылы серверге қосылу**

{% highlight bash %}
ssh root@x.x.x.x
mysql -uroot -px.x.x.x
{% endhighlight %}
Ең қарапайым тәсіл. Терминалымыздан ssh-арқылы қосыламыз да mysql-ді пайдалана береміз.

Артықшылықтары:

1. ештеңені баптаудың қажеті жоқ
2. байланыс ssh арқылы, яғни, қауіпсіз

Кемшілігі:

1. localhost-та тұрған бағдарлама mysql-мен байланыса алмайды, яғни, мускулмен тек терминал арқылы ғана жұмыс жасай аламыз


**2. SSH арқылы портты localhost-қа лақтыру**

Негізгі ой мынандай: айталық mysql серверде 3306 портында іске қосылған, біз ssh арқылы аламыз да сервердегі 
3306 портын localhost-тағы қалаған портымызға лақтырамыз, айталық 3307, яғни, localhost-тағы кез-келген 3307 
портына сұраныс серверге жіберіледі.

Портты былай лақтыруға болады ([бұл туралы мына мақалада толығырақ жазылған](/linux/2014/07/11/ssh.html)):

{% highlight bash %}
ssh -L :3307:127.0.0.1:3306 root@192.168.1.156
{% endhighlight %}
192.168.1.156 бұл біздің виртуалкамыздың ip адресі. Енді localhost-тан mysql-ге былай қосыламыз:
{% highlight bash %}
mysql -uroot -pxxxx -h 127.0.0.1 -P 3307
{% endhighlight %}

Артықшылықтары:

1. Байланыс ssh арқылы, қауіпсіз
2. Mysql localhost-та секілді болып тұрады, localhost-тағы бағдарламалар оңай жұмыс жасай алады

Кемшілігі:

1. Жұмыс кезінде лақтыру үшін орындаған команданы аяқтауға болмайды, ол әрдайым ашық тұруы керек


**3. Mysql серверінің өзінде қашықтықтан байланысуға рұқсат беру**

**<u><i>Бұл нұсқа шынайы серверлерге қолданылмауы тиіс. Қолдансаңыз, қауіпсіздік жағынан опық жеуіңіз мүмкін</i></u>**

Бұл нұсқада mysql серверін баптап, сырттан тікелей қосыла алатын етеміз. Ол үшін, mysql-дің баптау файлын <i>/etc/mysql/my.cnf</i> ашамыз (windows-та ол қайда жататынын білмеймін). Содан соң ондағы мынандай қатарды/баптауды табамыз:

    bind-address = 127.0.0.1

Бұл баптау mysql серверіне қандай ip адрестен қосылуға болатындығын көрсетеді, үнсіз келісім бойынша ол 127.0.0.1 (сондықтан да әдетте сіз тек localhost арқылы ғана қосыла аласыз). Оны сіз өз ip адресіңізге өзгертіп қоя аласыз, мысалы:

{% highlight bash %}
bind-address = 192.168.2.120
{% endhighlight %}

Өзгерткен соң mysql-ді қайта жүктеуді ұмытпаңыз. Бірақ бұлай жасасаңыз сіз 127.0.0.1 арқылы қосыла алмай қаласыз, сондықтан тестілік виртуалкаларда, барлық ip адрестер үшін рұқсат берген жөн. Олай жасау үшін, бұл баптауды комменттеп тастаңыз:

{% highlight bash %}
# bind-address = 192.168.2.120
{% endhighlight %}

Бірақ mysql сіздерге әлі де рұқсат бермейді, өйткені енді mysql сізді деректор қоры деңгейінде жібермейді.

Кез-келген хосттан және кез-келген деректер қорына кіре алу үшін mysql-де мынандай сұраныс орындаңыз:

{% highlight sql %}
GRANT ALL PRIVILEGES ON *.* TO root@'%' IDENTIFIED BY 'мұнда парольді жазыңыз';
{% endhighlight %}

"root" пайдаланушының орнына өзіңіздің пайдаланушы логинін жаза аласыз. Бұл командадан соң сіз, сырттан mysql-ге былай қосыла аласыз:

{% highlight bash %}
mysql -uroot -pxxxx -h 192.168.1.156 -P 3306
{% endhighlight %}


"xxxx" орнына grant all командасында көрсетілген парольді жазасыз.

Тағы да ескертемін бұл тәсілді тек тестілеу кезінде, бағдарлама жазу кезінде, виртуалкаларға ғана қолдану керек. Бірақ жұмыс жасау кезінде өте ыңғайлы

Артықшылықтары:

1. Кез-келген жерден қосылуға болады
2. Жұмыс жасау кезінде ыңғайлы

Кемшілігі:

1. Қауіпсіздік жағынан олқылықтар пайда болуы мүмкін
